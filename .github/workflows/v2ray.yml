name: Xray Server
on:
  workflow_dispatch:
jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - name: Get Server IP
        run: |
          echo "Server IP address:"
          curl https://api.ipify.org  # نمایش IP سرور در لاگ
      - name: Install Xray
        run: |
          wget https://github.com/XTLS/Xray-core/releases/latest/download/Xray-linux-64.zip -O xray.zip
          unzip xray.zip -d xray
          chmod +x xray/xray
      - name: Configure Xray
        run: |
          echo '{
            "inbounds": [{
              "port": 443,
              "protocol": "vless",
              "settings": {
                "clients": [{
                  "id": "UUID"
                }],
                "decryption": "none"
              },
              "streamSettings": {
                "network": "ws",
                "wsSettings": {
                  "path": "/yourpath"
                }
              }
            }],
            "outbounds": [{
              "protocol": "freedom",
              "settings": {}
            }]
          }' > xray/config.json
